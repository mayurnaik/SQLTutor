<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
	<f:event type="preRenderView" listener="#{userBean.devRedirect}" />
	<h:head>
		<title>SQL Tutor</title>
		<ui:insert name="menu">
			<ui:include src="/Menubar.xhtml" />
		</ui:insert>
	</h:head>
	<h:body>
		<h:form>
			<ui:insert name="template">
				<ui:include src="/BodyTemplate.xhtml" />
			</ui:insert>
	    	<div class="left2">
				<p:panel styleClass="panel">
					<h:link value="User Management" outcome="DevManageUsersPage" />
					<br/><br/>
					
					<h:link value="Statistics" outcome="DevStatisticsPage"/>	
					<br/><br/>	
					
					<h:link value="Instance View" outcome="DevInstancesPage" disabled="true"/>
				</p:panel>	
			</div>
			
			<div class="middle"/>
			
			<div class="right2">
		    	<p:messages />
		    	
		 		<p:panel classStyle="panel" header="Instance Data View" >
				    <p:tabView value="#{devSchemaInstancesPageBean.tables}" var="table"
				    	dynamic="true">
				        <p:tab title="#{table.tableName}" >
							<p:dataTable var="row" 
								value="#{devSchemaInstancesPageBean.tableData[table.tableName].data}" 
								resizableColumns="true"
								style="height:30% !important"
								scrollWidth="100%"
								scrollable="true">
								<p:columns value="#{devSchemaInstancesPageBean.tableData[table.tableName].columns}" style="white-space: normal;"
									var="column" columnIndexVar="columnIndex">
									<f:facet name="header">
										<p:outputLabel value="#{column}"/>
									</f:facet>
									<p:outputLabel value="#{row[columnIndex]}"/>
								</p:columns>
							</p:dataTable>
				        </p:tab>
				    </p:tabView>
				</p:panel>
				<br/>
				
				<p:panel classStyle="panel" header="Use this text entry box to alter and query the instance:">
					<p:inputTextarea rows="5" style="resize:none; width: 100%"
						autoResize="false" value="#{devSchemaInstancesPageBean.query}" />
					<br/>
					
					<p:commandButton id="try" value="Submit"
						action="#{devSchemaInstancesPageBean.processSQL}"
						ajax="false"
						styleClass="panelbutton"/>
					<br/><br/>
					
					<p:panel header="Result Set" styleClass="panel" style="width:100%">
						
						<p:dataTable id="resultsTable" var="row" 
							resizableColumns="true"
							style="height:30% !important;"
							scrollable="true"
							value="#{devSchemaInstancesPageBean.queryResult.data}">
							<p:columns value="#{devSchemaInstancesPageBean.queryResult.columns}" style="white-space: normal;"
								var="column" columnIndexVar="columnIndex">
								<f:facet name="header">
									<h:outputText value="#{column}"/>
								</f:facet>
								<h:outputText value="#{row[columnIndex]}"/>
							</p:columns>
						</p:dataTable>
					</p:panel>
				</p:panel>
			</div>
		</h:form>
	</h:body>
</html>